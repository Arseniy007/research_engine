{% extends "layout.html" %}
{% load static %}

{% block script %}
    <script src="{% static 'js/source_forms.js' %}"></script>
    <script src="{% static 'js/work_space_parts.js' %}"></script>
    <script src="{% static 'js/work_space.js' %}"></script>
{% endblock %}

{% block css %}
    <link href="{% static 'css/work_space/styles.css' %}" rel="stylesheet">
{% endblock %}

{% block title %}
    {{ space }}
{% endblock %}

{% block header %}
    {{ space }}
{% endblock %}

{% block body %}


    <form action="{% url 'work_space:rename_space' space.pk %}" id="rename_form" method="post">
        {% csrf_token %} 
        {{ rename_form }}
        <button type="submit">Rename space</button>
    </form><br><br>

    <form action="{% url 'paper_work:create_paper' space.pk %}" method="post">
        {% csrf_token %} 
        {{ form }}
        <button id="change_password_button" type="submit">Add Paper</button>
    </form>

    <ul>
        {% for paper in papers %}
        <li>
            <a href="{% url 'paper_work:paper_space' paper.pk %}">{{ paper }}</a>
        </li>
        {% endfor %}
    </ul><br><br>


    <ul>
        {% for book in books %}
        <li>
           <a href="{% url 'bookshelf:source_space' book.pk %}">{{ book }}</a>
        </li>
        {% endfor %}
    </ul><br><br><br><br>

    <h3>Test</h3>

    {% for source in sources %}
        <!-- Button trigger modal -->
        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#source-space-{{ source.pk }}">
            {{ source }}
        </button>
        
        <!-- Modal -->
        <div class="modal fade" id="source-space-{{ source.pk }}" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="source-space-label-{{ source.pk }}" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header">
                        <h1 class="modal-title fs-5" id="source-space-label-{{ source.pk }}">{{ source }}</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        Test!!!
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Understood</button>
                    </div>
                </div>
            </div>
        </div><br><br>
    {% endfor %}





    <li>
        <a href="{% url 'work_space:download_space' space.pk %}">Download space</a>
    </li><br><br><br>
    

    <button class="show_form_button" id="book" type="button">book</button>
    <button class="show_form_button" id="article" type="button">article</button>
    <button class="show_form_button" id="chapter" type="button">chapter</button>
    <button class="show_form_button" id="webpage" type="button">webpage</button>

    <form action="{% url 'bookshelf:add_source' space.pk %}" method="post" id="book_form" class="source_form">
        <div class="author_div"></div>
        {% csrf_token %} 
        {{ book_form.as_p }}
        <button value="book" name="book" type="submit">Add Book</button>
    </form>
    <form action="{% url 'bookshelf:add_source' space.pk %}" method="post" id="article_form" class="source_form">
        <div class="author_div"></div>
        {% csrf_token %} 
        {{ article_form.as_p }}
        <button value="article" name="article" type="submit">Add Article</button>
    </form>
    <form action="{% url 'bookshelf:add_source' space.pk %}" method="post" id="chapter_form" class="source_form">
        <div id="chapter_author_div"></div>
        {% csrf_token %}
        {{ chapter_form.as_p }}
        <div class="author_div"></div>
        <button value="chapter" name="chapter" type="submit">Add Chapter</button>
    </form>
    <form action="{% url 'bookshelf:add_source' space.pk %}" method="post" id="webpage_form" class="source_form">
        <div class="author_div"></div>
        {% csrf_token %} 
        {{ webpage_form.as_p }}
        <button value="webpage" name="webpage" type="submit">Add Webpage</button>
    </form><br><br><br><br>

    <h4>New comment:</h4>
    <form action="{% url 'work_space_parts:leave_comment' space.pk %}" id="comment_form" method="post">
        {% csrf_token %} 
        {{ comment_form }}
        <button type="submit">Add Comment</button>
    </form><br><br>
    <h4>New Note:</h4>
    <form action="{% url 'work_space_parts:leave_note' space.pk %}" id="note_form" method="post">
        {% csrf_token %} 
        {{ note_form }}
        <button type="submit">Add Note</button>
    </form><br><br>
    <h4>New Link:</h4>
    <form action="{% url 'work_space_parts:add_link' space.pk %}" id="link_form" method="post">
        {% csrf_token %} 
        {{ link_form }}
        <button type="submit">Add Link</button>
    </form><br><br>

    
    <h3>Comments:</h3>
    <ul>
        {% for comment in comments %}
        <div id="comment_{{ comment.pk }}">
            <li>{{ comment }}</li>
            <button onclick="return delete_comment('{{ comment.pk }}')" type="button">Delete Comment</button>
            <small>{{ comment.created }}</small>
            <div class="alter_comment_forms">
                <form action="{% url 'work_space_parts:alter_comment' comment.pk %}" id="alter_comment_form_{{ comment.pk }}" method="post">
                    {% csrf_token %} 
                    {{ alter_comment_form }}
                    <button>Alter Comment</button>
                </form>
            </div>
        </div>
        {% endfor %}
    </ul><br><br><br>

    <h3>Alter Comments:</h3>
    <button type="button" onclick="return leave_comment('{{ space.pk }}')">Test</button>
    <br><br><br>

    <h3>Notes:</h3>
    <ul>
        {% for note in notes %}
            <div id="note_{{ note.pk }}">
                <li>{{ note }}</li>
                <button onclick="return delete_note('{{ note.pk }}')" type="button">Delete Note</button>
                <small>{{ note.created }}</small>
            </div>
        {% endfor %}
    </ul><br><br><br>

                

    <h3>Alter Notes:</h3>
    # TODO
    <br><br><br>

    <h3>Links:</h3>
    <ul>
        {% for link in links %}
            <div id="link_{{ link.pk }}">
                <li>
                    <a href="{{ link.url }}">{{ link }}</a>
                    <button onclick="return delete_link('{{ link.pk }}')" type="button">Delete Link</button>
                    <small>{{ link.added }}</small>
                </li>
            </div>
            
        {% endfor %}
    </ul><br><br><br>

    <h3>Alter Links:</h3>
    # TODO
    <br><br><br>

    <div id="space_id" style="display: none;">{{ space.pk }}</div>



    


{% endblock %}
