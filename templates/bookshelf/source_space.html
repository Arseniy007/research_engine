{% extends "layout.html" %}
{% load static %}

{% block script %}
    <script src="{% static 'js/source.js' %}"></script>
{% endblock %}

{% block headless %}
    <div id="source_space">

        <h3>{{ source }}</h3>

        <!-- Messages -->
        {% if messages %}
            <div>
                <ul class="messages">
                    {% for message in messages %}
                        <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
                    {% endfor %}
                </ul>
            </div>
        {% endif %}

        
        <a href="{% url 'file_handling:display_source_file' source.pk %}"><h2>File</h2></a><br><br>

        <form enctype="multipart/form-data" action="{% url 'file_handling:upload_source_file' source.pk %}" method="post">
            {% csrf_token %} 
            {{ upload_file_form }}
            <button type="submit">Upload Book</button>
        </form>

        <br><br>

        <h4>Add link</h4>
        <form action="{% url 'bookshelf:add_link' source.pk %}" id="link_form" method="post">
            {% csrf_token %} 
            {{ link_form }}
            <button>Add</button>
        </form>
        <br><br>
        {% if source.link %}
            <div id="source_link">
                <h5><a id="link_tag" href="{{ source.link }}">Link</a></h5>
            </div>
        {% endif %}

        <br><br>

        <h4>Endnotes</h4>
        <ul>
            <li>{{ endnotes.apa }}</li>
            <li>{{ endnotes.mla }}</li>
        </ul>

        <form action="{% url 'bookshelf:alter_endnote' endnotes.pk %}" id="alter_endnote_form" method="post">
            {% csrf_token %} 
            {{ endnote_form }}
            <button>Alter Endnotes</button>
        </form>

    
        <br><br><br>
        <br><br><br>

        <form action="{% url 'bookshelf:alter_source' source.pk %}" method="post">
            {% csrf_token %} 
            {{ alter_source_form.as_p }}
            <button type="submit">Alter Source Info</button>
        </form>

        <br><br><br>
        <br><br><br>
        <br><br><br>

        <form action="{% url 'bookshelf:add_quote' source.pk %}" id="new_quote_form" method="post">
            {% csrf_token %} 
            {{ quote_form }}
            <button type="submit">Add Quote</button>
        </form>


        <h3>Quotes</h3>
        <ul>
            {% for quote in quotes %}
            <div id="quote_{{ quote.pk }}">
                <li>
                    {{ quote }} | Quote apa: {{ quote.apa }} | Quote mla: {{ quote.mla }}
                    <button class="delete_quote_buttons" id="{{ quote.pk }}">Delete Quote</button>
                </li>
            </div>
            {% endfor %}
        </ul>

        <div id="source_id" style="display: none;">{{ source.pk }}</div>

    </div>
{% endblock %}